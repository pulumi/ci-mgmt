# WARNING: This file is autogenerated - changes will be overwritten when regenerated by https://github.com/pulumi/ci-mgmt

name: command-dispatch
on:
  issue_comment:
    types:
    - created
    - edited

env:
#{{ .Config | renderGlobalEnv | indent 2 }}#

jobs:
  command-dispatch-for-testing:
    name: command-dispatch-for-testing
    runs-on: #{{ .Config.Runner.Default }}#
    permissions:
      contents: read
      pull-requests: write # For comment reactions.
      id-token: write # For ESC secrets.
    steps:
    - name: Checkout Repo
      uses: #{{ .Config.ActionVersions.Checkout }}#
      with:
        #{{- if .Config.CheckoutSubmodules }}#
        submodules: #{{ .Config.CheckoutSubmodules }}#
        #{{- end }}#
        persist-credentials: false
    #{{- .Config | renderEscStep | indent 4 }}#
    - uses: peter-evans/slash-command-dispatch@5c11dc7efead556e3bdabf664302212f79eb26fa # v5
      with:
        commands: |
          run-acceptance-tests
        issue-type: pull-request
        permission: write
        reaction-token: ${{ secrets.GITHUB_TOKEN }}
        repository: #{{ .Repository }}#
        token: ${{ steps.esc-secrets.outputs.PULUMI_BOT_TOKEN }}
