env:
  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
jobs:
  warn_codegen:
    name: warn_codegen
    runs-on: ubuntu-latest
    steps:
    - name: Checkout Repo
      uses: actions/checkout@v2
    - id: schema_changed
      name: Check for diff in schema
      uses: dorny/paths-filter@v2
      with:
        filters: "changed: 'provider/cmd/**/schema.json'"
    - id: sdk_changed
      if: steps.schema_changed.outputs.changed == 'false'
      name: Check for diff in sdk/*
      uses: dorny/paths-filter@v2
      with:
        filters: "changed: 'sdk/*'"
    - if: steps.sdk_changed.outputs.changed == 'true'
      name: Send codegen warning as comment on PR
      uses: thollander/actions-comment-pull-request@v1
      with:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        message: >
          Hello and thank you for your pull request! :heart: :sparkles:

          It looks like you're trying to directly modify files in the language SDKs, many of which are autogenerated.

          Please double check that you have [correctly generated any code](https://github.com/pulumi/${{ github.event.repository.name }}/blob/master/CONTRIBUTING.md#committing-generated-code).
name: warn-codegen
on:
  pull_request_target:
    branches:
    - main
    - master
